(function(d){d.widget("ui.droppable",{version:"1.10.3",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var a=this.options,b=a.accept;this.isover=!1;this.isout=!0;this.accept=d.isFunction(b)?b:function(a){return a.is(b)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};d.ui.ddmanager.droppables[a.scope]=
d.ui.ddmanager.droppables[a.scope]||[];d.ui.ddmanager.droppables[a.scope].push(this);a.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var a=0,b=d.ui.ddmanager.droppables[this.options.scope];b.length>a;a++)b[a]===this&&b.splice(a,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(a,b){"accept"===a&&(this.accept=d.isFunction(b)?b:function(a){return a.is(b)});d.Widget.prototype._setOption.apply(this,arguments)},_activate:function(a){var b=
d.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass);b&&this._trigger("activate",a,this.ui(b))},_deactivate:function(a){var b=d.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass);b&&this._trigger("deactivate",a,this.ui(b))},_over:function(a){var b=d.ui.ddmanager.current;b&&(b.currentItem||b.element)[0]!==this.element[0]&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),
this._trigger("over",a,this.ui(b)))},_out:function(a){var b=d.ui.ddmanager.current;b&&(b.currentItem||b.element)[0]!==this.element[0]&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",a,this.ui(b)))},_drop:function(a,b){var c=b||d.ui.ddmanager.current,g=!1;return c&&(c.currentItem||c.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var a=
d.data(this,"ui-droppable");return a.options.greedy&&!a.options.disabled&&a.options.scope===c.options.scope&&a.accept.call(a.element[0],c.currentItem||c.element)&&d.ui.intersect(c,d.extend(a,{offset:a.element.offset()}),a.options.tolerance)?(g=!0,!1):void 0}),g?!1:this.accept.call(this.element[0],c.currentItem||c.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",a,this.ui(c)),
this.element):!1):!1},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}});d.ui.intersect=function(a,b,c){if(!b.offset)return!1;var d,e,f=(a.positionAbs||a.position.absolute).left,h=f+a.helperProportions.width,m=(a.positionAbs||a.position.absolute).top,n=m+a.helperProportions.height,k=b.offset.left,p=k+b.proportions.width,l=b.offset.top,q=l+b.proportions.height;switch(c){case "fit":return f>=k&&p>=h&&m>=l&&q>=n;case "intersect":return f+
a.helperProportions.width/2>k&&p>h-a.helperProportions.width/2&&m+a.helperProportions.height/2>l&&q>n-a.helperProportions.height/2;case "pointer":return d=(a.positionAbs||a.position.absolute).left+(a.clickOffset||a.offset.click).left,e=(a.positionAbs||a.position.absolute).top+(a.clickOffset||a.offset.click).top,e>l&&l+b.proportions.height>e&&d>k&&k+b.proportions.width>d;case "touch":return(m>=l&&q>=m||n>=l&&q>=n||l>m&&n>q)&&(f>=k&&p>=f||h>=k&&p>=h||k>f&&h>p);default:return!1}};d.ui.ddmanager={current:null,
droppables:{"default":[]},prepareOffsets:function(a,b){var c,g,e=d.ui.ddmanager.droppables[a.options.scope]||[],f=b?b.type:null,h=(a.currentItem||a.element).find(":data(ui-droppable)").addBack();c=0;a:for(;e.length>c;c++)if(!(e[c].options.disabled||a&&!e[c].accept.call(e[c].element[0],a.currentItem||a.element))){for(g=0;h.length>g;g++)if(h[g]===e[c].element[0]){e[c].proportions.height=0;continue a}e[c].visible="none"!==e[c].element.css("display");e[c].visible&&("mousedown"===f&&e[c]._activate.call(e[c],
b),e[c].offset=e[c].element.offset(),e[c].proportions={width:e[c].element[0].offsetWidth,height:e[c].element[0].offsetHeight})}},drop:function(a,b){var c=!1;return d.each((d.ui.ddmanager.droppables[a.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&d.ui.intersect(a,this,this.options.tolerance)&&(c=this._drop.call(this,b)||c),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],a.currentItem||a.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,
b)))}),c},dragStart:function(a,b){a.element.parentsUntil("body").bind("scroll.droppable",function(){a.options.refreshPositions||d.ui.ddmanager.prepareOffsets(a,b)})},drag:function(a,b){a.options.refreshPositions&&d.ui.ddmanager.prepareOffsets(a,b);d.each(d.ui.ddmanager.droppables[a.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var c,g,e,f=d.ui.intersect(a,this,this.options.tolerance);(f=!f&&this.isover?"isout":f&&!this.isover?"isover":null)&&(this.options.greedy&&
(g=this.options.scope,e=this.element.parents(":data(ui-droppable)").filter(function(){return d.data(this,"ui-droppable").options.scope===g}),e.length&&(c=d.data(e[0],"ui-droppable"),c.greedyChild="isover"===f)),c&&"isover"===f&&(c.isover=!1,c.isout=!0,c._out.call(c,b)),this[f]=!0,this["isout"===f?"isover":"isout"]=!1,this["isover"===f?"_over":"_out"].call(this,b),c&&"isout"===f&&(c.isout=!1,c.isover=!0,c._over.call(c,b)))}})},dragStop:function(a,b){a.element.parentsUntil("body").unbind("scroll.droppable");
a.options.refreshPositions||d.ui.ddmanager.prepareOffsets(a,b)}}})(jQuery);