function gp_init_inline_edit(l,t,u){function b(a,d){var c=m(a);"undefined"!==typeof d&&c.val(d);return parseInt(c.val())}function m(a){return $("#gp_current_image input[name="+a+"]")}function r(){var a=posy=mouse_startx=mouse_starty=pos_startx=pos_starty=0,d=!1;f.disableSelection();f.mousedown(function(c){c.preventDefault();d=!0;pos_startx=a=e.posx||0;pos_starty=posy=e.posy||0;mouse_startx=c.pageX;mouse_starty=c.pageY}).on("mouseleave mouseup",function(a){a.preventDefault();d=!1}).mousemove(function(c){d&&
(a=pos_startx+c.pageX-mouse_startx,posy=pos_starty+c.pageY-mouse_starty,h(a,posy))})}function h(a,d){e.posx=a=b("left",a);e.posy=d=b("top",d);f.css({"background-position":a+"px "+d+"px"});g=!0}function n(a,d,c){delete e.src;a!==p&&(e.src=a);f.css({"background-image":'url("'+a+'")'});$("#gp_current_image img").attr("src",a);0<d&&0<c&&(b("width",d),b("height",c),f.stop(!0,!0).animate({width:d,height:c}))}function s(a){a.attr("action");a.find(".file").auto_upload({start:function(a,c){c.bar=$('<a data-cmd="gp_file_uploading">'+
a+"</a>").appendTo("#gp_upload_queue");return!0},progress:function(a,c,b){a=Math.round(100*a);a=Math.min(98,a-1);b.bar.text(a+"% "+c)},finish:function(a,c,b){b=b.bar;b.text("100% "+c);var e=$(a);a=e.find(".status").val();e=e.find(".message").val();"success"==a?(b.addClass("success"),b.slideUp(1200),c=$("#gp_gallery_avail_imgs"),$(e).appendTo(c)):"notimage"==a?b.addClass("success"):(b.addClass("failed"),b.text(c+": "+e))},error:function(a,b,e){alert("error: "+e)}})}$gp.LoadStyle("/include/css/inline_image.css");
var q=gp_editing.get_path(l),f=gp_editing.get_edit_area(l);f.addClass("gp_image_edit");var p=f.attr("src"),g=!1,e={};$gp.loaded();gp_editing.editor_tools();$("#ckeditor_controls").prepend('<div id="gp_folder_options"></div>');gp_editor={save_path:q,checkDirty:function(){return g},gp_saveData:function(){return jQuery.param(e)+"&cmd=save_image"},resetDirty:function(){g=!1},updateElement:function(){}};(function(){var a=strip_from(q,"?")+"?cmd=image_editor";$gp.jGoTo(a)})();var k=!1;gpresponse.image_options_loaded=
function(){var a=f.width(),d=f.height();b("orig_width",a);b("orig_height",d);n(p,a,d);r();f.attr("src",gp_blank_img);$("#gp_current_image input").on("keyup keydown change paste",function(){k&&clearTimeout(k);k=setTimeout(function(){g=!0;e.width=b("width");e.height=b("height");f.stop(!0,!0).animate({width:e.width,height:e.height});var a=b("left"),d=b("top");h(a,d)},400)})};$gp.links.gp_gallery_add=function(a){a.preventDefault();a=$(this).stop(!0,!0);var d=a.data("width"),c=a.data("height");n(a.attr("href"),
d,c);h(0,0);e.width=b("width");e.height=b("height");g=!0};$gp.links.show_uploaded_images=function(){LoadImages(!1)};$gp.links.deafult_sizes=function(){b("width",b("orig_width"));b("height",b("orig_height"));m("width").change();h(0,0)};gpresponse.gp_gallery_images=function(a){s($("#gp_upload_form"))}};