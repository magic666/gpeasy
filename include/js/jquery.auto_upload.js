(function(b){jQuery.fn.auto_upload=function(c){function d(){function g(h,g){var f={},l="undefined"!=typeof h.fileName?h.fileName:h.name;if(c.start(l,f)){var e=new XMLHttpRequest;e.onload=function(a){c.finish(e.responseText,l,f)};e.upload.onprogress=function(a){c.progress(a.loaded/a.total,l,f)};e.onerror=function(a){c.error(name,a,f)};var q=n.attr("method"),r=n.attr("action");e.open(q,r,!0);e.setRequestHeader("Cache-Control","no-cache");e.setRequestHeader("X-Requested-With","XMLHttpRequest");e.setRequestHeader("X-File-Name",
l);e.setRequestHeader("X-File-Size",h.fileSize);if(window.FormData){var p=new FormData;b.each(k,function(a,b){p.append(b.name,b.value)});p.append(d,h);e.send(p)}else if(h.getAsBinary){var m="------multipartformboundary"+(new Date).getTime();e.setRequestHeader("content-type","multipart/form-data; boundary="+m);var a="";b.each(k,function(b,c){a+="--"+m+"\r\n";a+='Content-Disposition: form-data; name="'+unescape(encodeURIComponent(c.name))+'"';a+="\r\n\r\n";a+=unescape(encodeURIComponent(c.value));a+=
"\r\n"});a+="--"+m+"\r\n";a+='Content-Disposition: form-data; name="'+d+'"; filename="'+unescape(encodeURIComponent(l))+'"';a+="\r\n";a+="Content-Type: application/octet-stream";a+="\r\n\r\n";a+=h.getAsBinary();a+="\r\n";a+="--"+m+"--";a+="\r\n";e.sendAsBinary(a)}}}var d=b(this).attr("name"),n=b(this.form),k=n.serializeArray();b.each(this.files,function(b,c){g(c,b)});this.form.reset()}function f(){$input=b(this);$form=b(this.form);$input.bind("change",function(){for(var g=this.value.toString();(pos=
g.search("\\\\"))&&-1!=pos;)g=g.substr(pos+1);var f={};c.start(g,f);var d="gp_"+Math.round(1E7*Math.random()),k=b('<iframe name="'+d+'" id="'+d+'" style="display:none"></iframe>').appendTo("body");$form.attr("target",d).one("submit",function(){k.one("load",function(){var b=k.contents().find("html").html();c.finish(b,g,f);setTimeout(function(){k.remove()},10)})}).submit()})}c=b.extend({},b.fn.auto_upload.defaults,c);var q=function(){var b=document.createElement("input");b.type="file";return"multiple"in
b&&"undefined"!=typeof File&&("undefined"!==typeof FormData||"undefined"!==typeof FileReader)&&"undefined"!=typeof XMLHttpRequest&&"undefined"!=typeof(new XMLHttpRequest).upload}();return b(this).each(function(){$this=b(this);q?($this.attr("multiple","multiple"),$this.bind("change.auto_upload",d)):f.call(this);$this.bind("destroy.auto_upload",function(){$this.unbind(".auto_upload")})})};b.fn.auto_upload.defaults={start:function(b,d){return!0},progress:function(b,d,f){},finish:function(b,d,f){},error:function(b,
d,f){}}})(jQuery);